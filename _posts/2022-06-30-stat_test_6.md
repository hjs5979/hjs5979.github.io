---
layout: single
title:  맥니머 검정, 코크란 Q 검정
categories: 검정
tag: [Statistic, Test]
use_math: true
toc: true
author_profile: true
sidebar:
  nav: docs
---

# 맥니머 검정

2x2 교차표에서 시행전/시행후의 결과를 A/B로 나눌 때, 성공과 실패가 일어날 확률에 차이가 있는지를 검정하는 방법입니다. 

$H_{0}$ : 시행전/시행후의 같은 결과가 나올 확률은 같다.(변화가 없다)

$H_{1}$ : 시행전/시행후의 같은 결과가 나올 확률은 같지 않다.(변화가 있다)

|시행전/시행후|A|B|
|-|-|-|
|A|a|b|
|B|c|d|

$T = \frac{(b-c)^2}{b+c}$가 $\chi^2(1)$를 따름

ex) 게임이 공부에 대한 흥미 미치는 영향에 대한 검정

$H_{0}$ : 게임전/게임후, 공부에 대한 흥미에는 변화가 없다.

$H_{1}$ : 게임전/게임후, 공부에 대한 흥미에 변화가 있다.

|게임전/게임후|흥미있음|흥미없음|
|-|-|-|
|흥미있음|9|12|
|흥미없음|30|35|

$T = \frac{(22 - 12)^2}{22 + 12} = 3.125$

$\chi^2(1)$이 3.84이므로 통계량이 기각역에 들지 못합니다. 그러므로 귀무가설을 수용하여 게임전/게임후의 공부에 대한 흥미에 변화가 없다는 결론을 내릴 수 있습니다.

```python
from statsmodels.stats.contingency_tables import mcnemar

contingency= pd.crosstab(df[i], df[i2])
print(mcnemar(contingency, exact=False))
```

# 코크란 Q 검정

크기가 n인 k차원 범주 데이터를 2값 변량  $x_{i}, y_{i}, \cdots , z_{i}$ 를 이용하여 다음과 같은 표로 정리했을 때 각 무리의 평균에 차이가 있는지를 검정하는 방법입니다.

$H_{0}$ : 각 무리의 평균이 모두 같다.

$H_{1}$ : 각 무리의 평균에 적어도 하나의 차이가 있다.

|-|개체1|개체2|$\cdots$|개체n|합계|
|-|-|-|-|-|-|
|1무리|$x_{1}$|$x_{2}$|$\cdots$|$x_{n}$|$B_{1}$|
|2무리|$y_{1}$|$y_{2}$|$\cdots$|$y_{n}$|$B_{2}$|
|$\vdots$||$\cdots\cdots$|||$B_{1}$|
|k무리|$z_{1}$|$z_{2}$|$\cdots$|$z_{n}$|$B_{k}$|
|합계|$L_{1}$|$L_{2}$|$\cdots$|$L_{n}$|N|


$T = \frac{(k-1)[k\sum_{i=1}^{k}B_{i}^2 - (\sum_{i=1}^{k}B_{i})^2]}{k\sum_{i=1}^{n}L_{i}-\sum_{i=1}^{n}L_{i}^2}$
가 $\chi^2(k-1)$를 따름

ex) 동물에 대한 좋고 싫음을 평가한 데이터

$H_{0}$ : 동물에 대한 좋음 비율이 모두 같다.

$H_{1}$ : 동물에 대한 좋음 비율이 적어도 하나에 차이가 있다.

|-|1|2|3|4|5|6|7|합계|
|-|-|-|-|-|-|-|-|-|
|고양이|1|1|0|1|0|0|1|4|
|개|0|1|1|0|1|1|1|5|
|햄스터|0|1|0|1|0|0|0|2|
|합계|1|3|1|2|1|1|2|11|

Q = 2.33

$\chi^2(2)$ = 5.99 이므로 귀무가설을 수용합니다. 즉, 독물에 대한 좋음 비율이 모두 같다는 결론을 내릴 수 있습니다.

```python
from statsmodels.stats.contingency_tables import cochrans_q

contingency= pd.crosstab(df[i], df[i2])
print(cochrans_q(contingency, exact=False))
```

이번 포스팅은 여기까지입니다.

# Reference

이시이 도시아키. 『통계학 대백과사전』. 안동현(역). 동양북스, 2022.




