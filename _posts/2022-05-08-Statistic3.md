---
layout: single
title:  베이즈 정리
categories: 확률
tag: [Statistic]
use_math: true
toc: true
author_profile: true
sidebar:
  nav: docs
---

베이즈 정리는 이전의 경험과 현재의 증거를 통해 어떤 사건의 확률을 추론하는 것입니다. 또는 어떤 사건이 서로 **배반하는** 원인 둘에 의해 일어난다고 할 때 실제 사건이 일어났을 때 이것이 두 원인 중 하나일 확률을 구하는 정리를 말합니다.

예를 들어, A는 코로나-37라는 질병에 대한 검사를 실시한다고 가정한다. 이 검사의 양성판정 정확도(양성인 사람이 양성이 나올 확률)이 90%이며, 음성판정 정확도(음성인 사람이 음성이 나올 확률)도 90%이다. . 또한 코로나-37은 전세계 인구 중 1%가 걸린 병이다. 그러면 검사 결과가 양성으로 나온 사람이 실제로 코로나-37에 걸려있을 확률은 몇일까.

통계적 계산 없이 간단히 생각해봤을 때, 양성판정 정확도가 90%이므로 이와 비슷한 확률이 나올 것으로 예측할 수도 있다.

하지만 실제로 계산을 해보면 생각과 다른 값이 나온다.

$P(양성)$ : 양성판정이 나올 확률
$P(코) = 0.01$ : 코로나-37에 걸려있을 확률
$P(양성|코) = 0.9$ : 양성판정 정확도
$P(음성|코) = 0.9$ : 음성판정 정확도

라고 생각했을 때, 우리가 구해야 할 것은 $P(코|양성)$ 이다. 이전 포스팅에서 배운 조건부확률을 이용하여 수식으로 다시 나타내면,

$$ P(코|양성) = \frac{P(코 \cap 양성)}{P(양성)}$$

로 나타난다. 여기서 $P(코 \cap 양성)$를 어떻게 구할 수 있을까. $P(코 \cap 양성)$를 또 다시 조건부확률을 통해 다음과 같이 새롭게 정의할 수 있다.

$$P(코 \cap 양성) = P(양성|코) \cdot P(코)$$

그러면 다시 다음과 같이 식을 바꾼다.

$$ P(코|양성) = \frac{P(양성|코) \cdot P(코)}{P(양성)}$$

다음 $P(양성)$의 값은 어떻게 구할 수 있을까.
여기서 배반사건의 개념을 이용한다. 코로나-37는 걸린 사람과 걸리지 않은 사람으로만 구분할 수 있으므로 두 사건은 서로 배반사건이다. 그러므로

$$P(양성) = P(양성|코) \cdot P(코) + P(양성|코\times) \cdot P(코\times)$$

로 나타낼 수 있다.

결국

$$P(코|양성) = \frac{P(양성|코) \cdot P(코)}{P(양성|코) \cdot P(코) + P(양성|코\times) \cdot P(코\times)}$$

로 식을 표현할 수 있고, 계산해보면, 0.083의 값(8.3%)을 얻을 수 있다. 양성이 나왔을 때, 코로나일 확률이 8.3%라는 것으로 해석할 수 있는데, 양성 판정의 정확도가 90%에 비하면 매우 적은 확률이다. 어떻게 이런 값이 나왔을 까?

이는 코로나에 걸려있을 확률이 1%이기 때문에 나타나는 현상이다. 나머지 99%에서 양성확진이라고 오진을 내리는 경우 때문에 매우 적은 확률이 나오는 것이다. 이것은 후에 나올 recall 개념과 관련이 있는데, 나중에 설명하도록 하자.

어쨋든 결과적으로는 코로나에 걸려있는 인구가 적기 때문에 걸리지 않은 사람 중에서의 음성 확진 정확도가 중요하게 된다.

우리는 위의 과정을 통해서 P(A|B)를 통해 P(B|A)를 구하는 방법을 공부해봤다.

ps. 역확률문제라고도 부르는 것 같네요.










