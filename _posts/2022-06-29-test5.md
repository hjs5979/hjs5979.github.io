---
layout: single
title:  피셔 정확 검정
categories: 검정
tag: [Statistic, Test]
use_math: true
toc: true
author_profile: true
sidebar:
  nav: docs
---

# 피셔의 정확검정

2x2 교차표(두개의 범주를 가진 두 범주형 변수)에서 변수간 독립성을 검정하되, 도수가 매우 적은 경우 사용가능한 검정방법입니다.

|-|X|Y|합계|
|-|-|-|-|
|Z|a|b|z|
|W|c|d|w|
|합계|x|y|n|

위의 표대로 교차표가 생성될 확률은

$P = \frac{x!y!z!w!}{n!a!b!c!d!}$

각 도수의 합계가 변하지 않는 선에서의 모든 확률을 구해주고 실제 관측의 확률보다 작은 확률 값을 모두 더해줍니다. 이 확률이 유의수준을 넘는지 넘지 않는지 확인하면 됩니다.

ex)

$H_{0}$ : 성별에 따라 카드(다이아,클로버)선택에는 차이가 없다(독립)

$H_{1}$ : 성별에 따라 카드(다이아,클로버)선택에는 차이가 있다

|-|다이아|클로버|합계|
|-|-|-|-|
|남|2|2|4|
|여|1|5|6|
|합계|3|7|10|

설문조사결과 위와 같이 교차표가 만들어졌을 때, 가능한 경우의 수는 다음과 같습니다.

|-|다이아|클로버|합계|
|-|-|-|-|
|남|0|4|4|
|여|3|3|6|
|합계|3|7|10|

|-|다이아|클로버|합계|
|-|-|-|-|
|남|1|3|4|
|여|2|4|6|
|합계|3|7|10|

|-|다이아|클로버|합계|
|-|-|-|-|
|남|3|1|4|
|여|0|6|6|
|합계|3|7|10|

모든 경우의 수의 확률을 구해주고 더해줍니다.

실제 관측 확률 = $\frac{3!7!4!6!}{10!2!2!1!5!}$ = 0.3

경우1 = $\frac{3!7!4!6!}{10!0!4!3!3!}$ = 0.167

경우2 = $\frac{3!7!4!6!}{10!1!3!2!4!}$ = 0.5

경우3 = $\frac{3!7!4!6!}{10!3!1!0!6!}$ = 0.03

관측확률보다 낮게 나온 0.167과 0.03을 실제 관측확률인 0.3에 더해주면 0.497의 값이 나오게 됩니다. 유의수준을 0.05로 할 경우 유의수준보다 높은 값이 나왔으므로 귀무가설을 수용하여 성별과 카드선택은 독립이다라는 결론을 내릴 수 있습니다.

```python
from scipy.stats import fisher_exact
 
contingency= pd.crosstab(df[i], df[i2])
f, p =stats.fisher_exact(contingency)

```