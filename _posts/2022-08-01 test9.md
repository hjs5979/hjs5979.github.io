---
layout: single
title:  크루스칼-윌리스 검정, 프리드먼 검정
categories: 검정
tag: [Statistic, Test]
use_math: true
toc: true
author_profile: true
sidebar:
  nav: docs
---
# 크루스칼-윌리스 검정

크루스칼-윌리스 검정은 대응 관계가 없는 집단의 차이를 검정하는 검정방법입니다. 대응 관계가 없는 k개의 집단의 데이터에서 각 집단의 데이터 크기를 $n_i$, k개 집단 전체 데이터의 크기를 n, 제 i 집단의 순위합을 $R_i$로 정합니다. (순위합은 집단 순위(1~k)와 집단 내 순위(1~ $n_i$)를 더한 것입니다.)

n이 충분히 클 때, 각 집단이 같은 분포를 따른다는 가정 하에 

$H = \frac{12}{n(n+1)}\sum_{i=1}^{k}{\frac{R^2_{i}}{n_{i}}}-3(n+1)$ 는 자유도 k-1인 카이제곱분포 $\chi^2(k-1)$를 따름

$H_{0}$ : 집단 간의 차이가 없다.

$H_{1}$ : 집단 간의 차이가 있다.

ex)
고객 1,2,3,4에게 기업 A,B,C에 대한 평가설문조사 실시한 결과입니다.

|-|1|2|3|4|
|-|-|-|-|-|
|A|5|5|4|
|B|4|3|2|
|C|3|2|1|1|

(고객 4의 경우에는 C기업에 대한 질문에만 답했습니다.)

H=6.36으로 계산되고, $\chi^2(10)$를 따르는 것이 보통이지만 위의 예시에서는 표본이 매우 작으므로 크루스칼-윌리스 검정표를 따릅니다.(교재에는 있지만 검색으로는 찾기 어렵습니다.) 이 값이 5.791이므로 통계값이 더 큽니다. 때문에 귀무가설을 기각하여, 리서치 기업의 설문조사 결과에는 차이가 있다는 결론을 내릴 수 있습니다.

# 프리드먼 검정

프리드먼 검정은 대응 관계가 있는 여러 집단의 차이를 검정합니다. 크기가 n인 k개 무리가 있고, 각 집단의 데이터는 각각 $(x_{1} \cdots x_{n}), (y_{i} \cdots y_{n}), \cdots$라고 가정합니다.또한 각 집단의 데이터를 순위로 바꾼 데이터는 $(a_{1} \cdots a_{n}), (b_{i} \cdots b_{n}), \cdots$라 가정합니다.

첫번째 무리의 순위합은 $R = \sum_{i=1}^{n}a^{n}$ 이 되고 두번째 무리의 순위합은 $R = \sum_{i=1}^{n}b^{n}$가 될 것입니다. 이러한 가정 하에 n이 충분히 클 때, $Q = \frac{12}{nk(k+1)}\sum_{i=1}R_{i}^2-3n(k+1)$는 $\chi^2(k-1)$를 근사적으로 따릅니다.

$H_{0}$ : 집단 간의 차이가 없다.

$H_{1}$ : 집단 간의 차이가 있다.

ex)
고객 1,2,3,4에게 기업 A,B,C에 대한 평가설문조사 실시한 결과입니다.

|-|1|2|3|4|
|-|-|-|-|-|
|A|5|5|4|2|
|B|4|3|2|1|
|C|3|2|1|1|

순위변환
|-|1|2|3|4|
|-|-|-|-|-|
|A|1|1|2|3|
|B|1|2|3|4|
|C|1|2|3|3|


Q는 다음과 같이 계산됩니다.

$R_{1}=7, R_{1}=10, R_{3}=9 $

$Q = \frac{12}{12(3+1)}(7^2+10^2+9^2)-12(3+1) = 9.5$

본 예시에서는 n이 작으므로 프리드먼 검정표를 사용합니다. 검정표에 따르면 검정값이 6.5이므로 귀무가설을 기각하고 대립가설을 채택합니다. 네 명의 고객의 설문조사 결과에는 차이가 있다고 결론짓습니다.